# 명령어 모음
나중에 쉽고 빠르게 찾아 볼 수 있도록 우분투 아주 기초 명령어만 정리
## 1. 디렉터리 관련 명령어 정리
- pwd : 현재 위치 확인 
- cd : 이동 
- ls : 디렉터리 안 내용 출력 
  - ls -a : 숨긴 파일 모두 출력 
  - ls -d : 디렉터리 자체의 정보 출력 
  - ls -i : 첫번째 행에 inode 번호를 출력 (inode: 파일, 디렉토리에 관한 정보를 가지는 숫자)
  - ls -A : .(마침표)와 ..(마침표 두 개)를 제외한 모든 파일 목록 출력 
  - ls -F : 파일 종류를 표시 (*: 실행 파일, /: 디렉터리, @: 심볼릭 링크 파일)
  - ls -L : 심볼릭 링크의 경우 원본 파일의 정보 출력 
  - ls -R : 하위 디렉터리의 목록 출력
- mkdir : 디렉터리 생성
  - mkdir -p : 하위 디렉터리를 계층적으로 생성할 때 중간 단계의 디렉터리를 자동 생성해 줌
- rmdir : 디렉터리 삭제 
  - rmdir -p : 지정한 디렉터리를 삭제할 때 부모 디렉터리가 빈 경우 같이 삭제
## 2. 파일 관련 명령어
- cat : 파일의 내용 출력
    - cat -n : 행 번호를 붙여서 출력
- more : 파일의 내용을 화면 단위로 출력
    - more +행번호 : 출력을 시작할 행 번호를 지정 (실제로 + 붙이는 것)
- less : 파일의 내용을 화면 단위로 출력
    - j : 아래 방향키
    - k : 위 방향 키
    - space bar, Ctrl + f : 다음 페이지로 이동
    - Ctrl + b : 이전 페이지로 이동
    - /문자열 : 해당 문자열을 찾아줌
    - q : 종료
- head : 파일의 첫 번째 행부터 n 행까지 출력
    - head -숫자 : 출력할 행 수를 지정
- tail : 파일 뒷부분의 n행을 출력
    - tail +숫자 : 지정한 행부터 끝까지 출력
    - tail -숫자 : 뒷부분의 n행부터 끝까지 출력
    - tail -f : 파일 출력을 종료하지 않고 주기적으로 계속 출력
- cp : 파일이나 디렉터리 복사
    - cp -i : 파일을 덮어쓸지 물어본다
    - cp -r : 디렉터리를 복사할 때 지정
- rm : 파일이나 디렉터리를 삭제
    - rm -i : 삭제 여부를 묻는다
- ln : 파일 링크 생성
    - ln -s : 심볼릭 링크 파일 생성
- touch : 빈 파일 생성
- grep : (파일 내 검색) 지정한 패턴이 포함된 행 찾기
    - grep [옵션][패턴] [파일] → 패턴과 파일명 헷갈리지 않기
    - grep -i : 대소문자 구분 없이 검색
    - grep -l : 지정한 패턴이 포함된 파일명 검색
    - grep -n : 행 번호 출력
- find : 지정한 경로에서 검색 조건에 맞는 파일 찾기
    - find [경로][검색 조건] [동작]
    - find -name filename : 파일명으로 검색
    - find -type 파일 종류
    - find -user 사용자 : 지정한 사용자의 소유 파일 검색
    - find -perm 권한 : 지정한 권한과 일치하는 파일 검색
    - find [검색 조건] -exec 명령{}\; : 검색된 파일에 명령을 실행
    - find [검색 조건] -ok 명령{}\;
    - find [검색 조건] -print
    - find [검색 조건] -ls
- whereis : 지정된 경로에서 명령의 바이너리 파일이나 메뉴얼 파일의 위치를 찾음
    - whereis -b : 바이너리 파일만 검색
    - whereis -m : 메뉴얼 파일만 검색
    - whereis -s : 소스 파일만 검색
- which : 명령 파일의 위치를 찾아 그 경로를 추적 (ex. ls, pwd, cd)

## 3. 문서 편집 관련 명령어
- vi : 지정한 파일 편집

### 3.1 종료 관련
- q : 종료
- q! : 강제 종료
- w : 파일 저장
- wq : 저장 후 종료
- wq! : 강제 저장 후 종료
- ZZ : 작업한 내용을 저장하고 vi를 종료
- shift + zz : 작업한 내용을 저장하고 vi를 종료

### 3.2 입력 모드 전환
- i : 현재 커서 위치에 글자 입력
- I : 현재 행 처음에 글자 입력
- a : 현재 커서 다음 위치에 글자 입력
- A : 현재 행 마지막에 글자 입력
- o : 아래 행에 글자 입력
- O : 위 행에 글자 입력

### 3.3 커서 이동
- hjkl : 왼 아 위 오
- w : 다음 단어 첫 문자로 이동
- b : 이전 단어 첫 문자로 이동
- CTRL + f : 한 페이지 아래로 커서 이동
- CTRL + b : 한 페이지 위로 커서 이동
- G : 마지막 행으로 커서 이동
- [n] G : n 행으로 커서 이동
- :행 번호 : 지정한 행으로 커서 이동

### 3.4 내용 수정
- s : 현재 커서 글자를 지우고 입력 모드로 전환
- r : 현재 커서 글자 지우고 한 글자 입력 후 명령 모드
- cw : 현재 커서 위치부터 현재 단어의 끝까지 수정
- cc : 현재 커서가 위치한 행의 내용을 모두 수정
- C : 현재 커서 위치부터 행의 끝까지 수정

### 3.5 내용 삭제
- x : 현재 커서 위치의 한 글자 삭제
- X : 현재 커서 위치 이전 한 글자 삭제
- dw : 현재 커서 위치의 단어 삭제
- db : 현재 커서 위치 이전 단어 삭제
- dd : 현재 커서 위치의 행 삭제
- [n]dd : 현재 커서 위치의 아래 n 행을 삭제
- d^ : 현재 행에서 현재 커서 위치 이전 행 삭제
- d$ : 현재 행에서 현재 커서 위치 이후 행 삭제
- D : d$와 같음

### 3.6 명령 취소
- u : 이전 명령을 취소
- U : 해당 행에서 한 모든 명령을 취소
- e! : 마지막으로 저장한 내용 이후의 것을 모두 취소
- CTRL + r : 이전 취소한 명령을 취소

### 3.7 복사 및 붙여넣기
- yy : 현재 커서 위치의 행을 복사
- [n]yy : 현재 커서에서 아래의 n 행을 복사
- p : 현재 커서 위치 아래 행에 붙여 넣기
- P : 현재 커서 위치 위 행에 붙여 넣기
- yw : 현재 커서 이후 단어 복사
- yb : 현재 커서 이전 단어 복사

### 3.8 검색
- /문자열 : 문자열을 아래 방향으로 검색
- ?문자열 : 문자열을 위 방향으로 검색
- n : 다음 문자열 검색
- N : 이전 문자열 검색

### 3.9 바꾸기
- :s/문자열1/문자열2 : 현재 커서 위치 행에서 첫 번째 나오는 문자열1을 문자열2로 변경
- :%s/문자열1/문자열2 : 파일 전체에서 모든 문자열1을 문자열2로 변경

### 3.10 파일 관련 단축키
- :r 파일 : 지정한 파일을 읽어 들여 현재 커서 위치에 삽입
- :e : 지정한 파일로 전환 - 저장 완료 후 가능
- :n : vi 시작 시 여러 파일을 지정했을 경우 다음 파일로 전환

### 3.11 셀 명령 실행
- :! 셀명령 : vi 작업을 잠시 중단하고 셀 명령을 실행. 다시 vi로 돌아오려면 ENTER 누르기
- :sh : vi에서 빠져 나와 셀 명령을 실행. 다시 vi로 돌아오려면 exit를 입력

### 3.12 환경 설정 명령
- :set nu : 파일 내용의 각 행에 행 번호를 표시
- :set nonu : 행 번호 표시를 취소
- :set list : 눈에 보이지 않는 특수 문자를 표시
- :set nolist : 특수 문자 표시를 취소
- :set showmode : 현재 모드 표시
- :set noshowmode : 현재 모드 표시 취소
- :set : set으로 설정한 모든 vi 환경 설정 값을 출력
- :set all : 모든 vi 환경 변수와 현재 값 출력

## 4. 콘솔 단축키
- `Shift + PageUp` : 상위 페이지 이동
- `Shift + PageDown` : 아래 페이지 이동

### 4.1 터미널 실행 관련 단축키
- `Ctrl + Alt + T` : 터미널 실행
- `Ctrl + Shift + T` : 터미널내에서 새로운 탭으로 터미널 실행
- `Ctrl + Shift + N` : 터미널내에서 새로운 창으로 터미널 실행
- `Ctrl + Shift + W` : 탭으로 실행된 터미널 종료
- `Ctrl + Shift + Q` : 현재 터미널 종료
- `Ctrl + Shift + F` : 터미널내에서 문자열 검색

### 4.2 터미널내에서의 단축키
- `Shift + Ctrl + C` : 복사하기
- `Shift + Ctrl + V` : 붙여넣기
- `Ctrl + L` : 화면 Clear
- `Alt + F1 ~ F12` : 콘솔 이동
- `Alt + (Left / Right)` : 이전/다음 콘솔로 이동
- `Ctrl + Scroll Lock` : 프로세스 목록보기
- `Shift + Scroll Lock` : 메모리상태 정보보기

### 4.3 셀 상에서 실행 중인 프로그램을 제어하는 단축키
- `Ctrl + C` : 실행 중인 프로그램 중지
- `Ctrl + Z` : 실행 중인 프로그램 일시 정지
- `%` : 일시 정지된 프로그램 다시 실행

### 4.4 bash 상에서 기본 입력 모드인 emacs 스타일일 경우
- `Tab` : 자동 완성
- `Ctrl + D` : 로그아웃
- `Ctrl + R` : 히스토리 찾기
- `Ctrl + S` : 키보드 잠그기
- `Ctrl + Q` : 잠긴 키보드 풀기
- `Ctrl + M` : Enter
- `Ctrl + P` : 이전 명령어 (Up)
- `Ctrl + N` : 다음 명령어 (Down)
- `Ctrl + L` : 화면 지우기 (clear)
- `Ctrl + Y` : 버퍼의 내용 붙여넣기
- `Ctrl + A` : 입력 라인의 처음으로 이동 (Home)
- `Ctrl + E` : 입력 라인의 끝으로 이동 (End)
- `Ctrl + B` : 커서를 왼쪽으로 이동 (Left)
- `Ctrl + F` : 커서를 오른쪽으로 이동 (Right)
- `Ctrl + XX` : 커서를 이전 위치로 이동
- `Ctrl + U` : 커서 왼쪽의 문자들을 버퍼에 저장 후 삭제
- `Ctrl + K` : 커서 오른쪽의 문자들을 버퍼에 저장 후 삭제
- `Alt + L` : 커서 위치에서 문자열 끝까지 소문자로 변환
- `Alt + U` : 커서 위치에서 문자열 끝까지 대문자로 변환
- `Alt + T` : 두 단어 위치 바꾸기
- `Alt + B` : 커서를 다음 단어로 이동
- `Alt + F` : 커서를 이전 단어로 이동


# chroot
chroot(change root)는 리눅스에서 프로세스가 보는 루트 디렉토리(/)를 특정 디렉토리로 변경하는 시스템 콜입니다.

## chroot의 개념
일반적으로 리눅스 시스템에서 모든 프로세스는 /을 루트 디렉토리로 인식합니다. 하지만 chroot를 사용하면 특정 디렉토리를 새로운 루트 디렉토리로 설정할 수 있어, 해당 프로세스는 그 디렉토리 밖으로는 접근할 수 없게 됩니다.

## 작동 방식
예를 들어 `/home/user/jail` 디렉토리에 chroot를 설정하면:
- 이 프로세스에게는 `/home/user/jail`이 `/`로 보입니다 
- `/home/user/jail/bin`은 `/bin`으로 보입니다
`/home/user/jail` 밖의 디렉토리는 접근할 수 없습니다

## 주요 용도
- **보안 격리**: 웹 서버나 FTP 서버를 chroot 환경에서 실행하여 시스템의 다른 부분에 접근하지 못하게 합니다. 
- **개발 환경**: 다른 리눅스 배포판의 환경을 시뮬레이션할 때 사용합니다. 
- **시스템 복구**: 부팅할 수 없는 시스템을 외부에서 마운트하여 복구 작업을 할 때 사용합니다.

## 기본 사용법
```bash
# chroot 환경 준비
sudo mkdir -p /chroot/jail/{bin,lib,lib64,etc}

# 필요한 바이너리와 라이브러리 복사
sudo cp /bin/bash /chroot/jail/bin/
sudo cp /lib/x86_64-linux-gnu/libc.so.6 /chroot/jail/lib/

# chroot 실행
sudo chroot /chroot/jail /bin/bash
```
chroot는 완전한 보안 솔루션은 아니지만, 프로세스를 특정 디렉토리 트리로 제한하여 시스템을 보호하는 유용한 도구입니다.

## `sudo chroot /chroot/jail /bin/bash` 명령의 두 번째 파라미터 `/bin/bash` 의 역할
sudo chroot /chroot/jail /bin/bash에서 두 번째 파라미터 /bin/bash는 **chroot 환경에서 실행할 명령(프로그램)**을 지정합니다.

### 구체적인 역할
chroot 명령의 구조는 다음과 같습니다:

```bash
chroot [새로운 루트 디렉토리] [실행할 명령]
```
따라서 /bin/bash는
- chroot 환경이 설정된 후에 실행될 프로그램을 의미합니다 
- 이 경우 bash 셸을 실행하여 사용자가 chroot 환경에서 대화형으로 작업할 수 있게 합니다

### 경로 해석 방식
중요한 점은 이 /bin/bash 경로가 chroot된 환경 기준으로 해석된다는 것입니다.
- 실제 파일 위치: `/chroot/jail/bin/bash`
- chroot 환경에서는: `/bin/bash`로 인식됨

### 다른 명령 예시
bash 대신 다른 명령도 실행할 수 있습니다.
```bash
# ls 명령 실행 후 종료
sudo chroot /chroot/jail /bin/ls

# 특정 스크립트 실행
sudo chroot /chroot/jail /usr/local/bin/myscript.sh

# 웹 서버 실행
sudo chroot /chroot/jail /usr/sbin/nginx
```

### 명령을 생략하면?
두 번째 파라미터를 생략하면 기본적으로 /bin/sh가 실행됩니다.
```bash
sudo chroot /chroot/jail
# 위 명령은 sudo chroot /chroot/jail /bin/sh 와 동일
```
따라서 /bin/bash는 chroot 환경에 진입한 후 사용자와 상호작용할 수 있는 셸을 제공하는 역할을 합니다.