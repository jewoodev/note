# 체인지 버퍼

레코드가 변경될 때 데이터 파일만 변경되는게 아니라 해당 테이블에 포함된 인덱스를 업데이트하는 작업도 필요하다. 그런데 인덱스를 업데이트하는 작업은 랜덤하게 디스크를 읽는 작업을 필요로 해서 테이블에 인덱스가 많다면 성능에 영향을 줄 수 있다. 그래서 InnoDB는 변경해야할 인덱스 페이지가 버퍼 풀에 있으면 바로 업데이트를 수행하지만, 그렇지 않고 디스크에서 읽어와야 하면 이를 즉시 실행하지 않고 임시 공간에 저장해두고 사용자에겐 결과를 반환하는 형태로 성능을 향상시키는데, 여기서 말하는 임시 공간이 체인지 버퍼이다.

유니크 인덱스는 결과를 사용자에게 반환하기 전에 반드시 중복 체크를 해야해서 체인지 버퍼를 사용할 수 없다. 

체인지 버퍼에 임시로 저장된 인덱스 레코드 조각은 백그라운드 스레드에 의해 병합되는데, 이 스레드를 체인지 버퍼 머지 스레드라고 한다.

체인지 버퍼는 기본적으로 버퍼 풀로 설정된 메모리 공간의 25%까지 사용할 수 있게 설정되어 있고, 필요하다면 50%까지 높일 수 있고 반대로 낮출 수도 있다.

