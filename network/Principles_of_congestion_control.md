네트워크 혼잡 원인을 처리하기 위해서는 네트워크 혼잡을 일으키는 송신자들을 **억제**하는 메커니즘이 필요하다.

이 절에서는 혼잡이 왜 나쁜지, 네트워크 혼잡을 피하거나 대응하기 위해 취할 수 있는 다양한 접근 방식에서 성능이 어떻게 나타나는지 일반적인 문맥에서 살펴본다. 

## 1. 혼잡의 원인과 비용
혼잡 제어가 발생하는 점차 복잡해지는 일반적인 세 가지 시나리오를 살펴보며 먼저 혼잡의 원인과 비용에 대해 알아보자.

### 1.1 시나리오 1: 2개의 송신자와 무한 버퍼를 갖는 하나의 라우터
두 호스트 A와 B가 각각 출발지와 목적지 사이에 단일 홉을 공유하는 연결을 갖는다고 가정하자. 각 호스트의 애플리케이션들의 전송량은 동일하고 라우터는 출력 링크의 용량을 초과하여 입력되는 패킷들을 저장하는 버퍼를 갖고 있으며, 그 버퍼의 공간이 무제한이라고 가정하자. 

공유 출력 링크의 용량이 R이면 0과 R/2 사이의 전송률에 대해 수신자의 처리량은 송신자의 전송률과 같다. 링크가 안정 상태일 때 R/2를 초과해 패킷을 수신자에게 전달할 수 없다. 만약 호스트 A나 B가 그걸 넘어서서 전송률을 높이더라도 각자 R/2보다 높은 처리량을 결코 얻을 수 없다.

연결당 R/2의 처리량을 얻는 것은 목적지에 패킷을 전달하는 데 링크를 최대로 활용하므로 좋은 현상이다. 그러나 '전송률'과 '지연'의 관계에서는 링크 용량에 전송률이 가까워질수록 평균 지연이 지수 그래프처럼 커진다. 전송률이 R/2를 초과할 때, 라우터 안에 큐잉된 패킷의 평균 갯수는 제한되지 않고 커지며 출발지와 목적지 사이의 평균 지연이 무제한이 된다.

따라서 R 근처의 전체 처리량에서 동작하는 것은 처리량 관점에서는 이상적이지만, 지연 관점에서는 이상적이지 않다. 

### 1.2 시나리오 2: 2개의 송신자, 유한 버퍼를 가진 하나의 라우터
두 가지 방식으로 시나리오 1을 변경하자. 

첫째, 라우터 버퍼의 공간이 유한하다. 즉, 버퍼가 가득차있을 때 도착하는 패킷들은 버려진다. 둘째, 각 연결은 신뢰적이라고 가정한다. 트랜스포트 계층 세그먼트를 포함하는 패킷이 라우터에서 버려지면, 결국 송신자에 의해 재전송될 것이다. 패킷이 재전송될 수 있으므로, 송신율이라는 용어의 의미가 조금 더 예민해진다. 특히, 애플리케이션이 원래의 데이터를 소켓으로 보내는 송신율을 $\lambda_{in}$ 바이트/초 로 표기하자. 네트워크 안으로 세그먼트(원래 데이터와 재전송 데이터를 포함)를 송신하는 트랜스포트 계층에서의 송신율은 $\lambda\prime_{in}$ 바이트/초로 표시하고, $\lambda\prime_{in}$은 때때로 네트워크에 **제공된 부하**라고 부른다.

시나리오 2에서는 성능이 재전송이 어떻게 수횅되는지에 따라 좌우될 것이다. 첫째로, 호스트 A가 라우터의 버퍼가 비어있는지 여부를 알 수 있고(비현실적이지만 그렇다고 가정), 버퍼가 비어 있을 때만 패킷을 송신할 수 있는 경우를 살펴보자. 이러한 경우 $\lambda_{in}$와 $\lambda\prime_{in}$이 같으므로 어떠한 손실도 발생하지 않고, 연결의 처리량은 $\lambda_{in}$이 된다. 처리율 관점에서 보면 송신된 모든 것이 수신되기 때문에 성능은 이상적이다. 패킷 손실이 절대 발생하지 않는다고 가정하므로, 이 시나리오에서 평균 호스트 송신율은 R/2를 초과할 수 없다.

다음은 패킷이 확실히 손실된 것을 알았을 때만 송신자가 재전송하는 좀 더 현실적인 경우를 살펴보자. 이때는 전송율이 감소하게 될 텐데 이를 R/3이라고 하면, 전송된 데이터인 R/2 중에 0.333R 바이트/초(평균)은 원래의 데이터이고, 초당 0.166R 바이트/초(평균)는 재전송 데이터가 된다. 여기서 혼잡 네트워크의 또 다른 비용을 알 수 있다. 즉, 송신자는 버퍼 오버플로 때문에 버려진 패킷을 보상하기 위해 재전송을 수행해야 한다.

마지막으로, 송신자에서 너무 일찍 타임아웃되어 패킷이 손실되지 않았음에도 수신자의 큐에서 지연되고 있는 패킷을 송신자가 재전송하는 경우를 생각해보자. 이럴 때는 처음 보낸 패킷과 재전송된 패킷 둘다 수신자에게 도착한다. 수신자는 하나의 패킷 복사본만 필요하기 때문에 하나는 버리게 된다. 결과적으로 라우터에서 재전송된 복사본을 전달하는 작업은 낭비가 된다. 그 작업 대신 라우터가 다른 패킷을 송신하기 위해 링크 전송 용량을 사용하는 것이 더 좋다. **이것은 혼잡 네트워크의 또 다른 비용이다. 커다란 지연으로 인산 송신자의 불필요한 재전송은 라우터가 링크 대역폭을 낭비하게 하는 원인이 된다.** 

### 1.3 시나리오 3: 4개의 송신자와 유한 버퍼를 갖는 라우터, 그리고 멀티홉 경로
이 시나리오에서 4개의 호스트는 겹쳐지는 2홉 경로를 통해 패킷을 전송한다. 각각의 호스트는 안정적인 데이터 전송 서비스를 제공하기 위해 타임아웃/재전송 메커니즘을 사용한다고 가정한다. 모든 호스트는 $\lambda_{in}$의 동일한 값을 갖고, 모든 라우터 링크는 R 바이트/초 용량을 갖는다고 가정한다.

라우터 R1과 R2를 지나가는 호스트 A ~ C 연결을 살펴보자. A ~ C 연결은 D ~ B 연결과 라우터 R1을 공유한다. 그리고 B ~ D 연결과 라우터 R2를 공유한다. 이 전제 하에 트래픽이 아주 적은 경우를 살펴보자. $\lambda_{in}$의 극히 작은 값에 대해 버퍼 오버플로는 거의 발생하지 않고, 혼잡 시나리오 1과 2처럼 처리량은 제공된 부하와 거의 같다. $\lambda_{in}$의 약간 더 큰 값에 대해 원래의 데이터가 네트워크로 전송되고, 목적지에 전달되고, 오버플로가 거의 발생하지 않으므로, 해당하는 처리량은 약간 커진다. 그러므로 $\lambda_{in}$이 작은 값일 때, $\lambda_{in}$의 증가는 $\lambda_{out}$의 증가를 가져온다.

이젠 트래픽이 매우 큰 경우를 살펴보자. 라우터 R2를 고려해보자. 라우터 R2에 도착하는 (R1에서 전달된 후 R2에 도착한) A ~ C 트래픽은 R2에서 $\lambda_{in}$값에 관계없이, R1에서 R2까지의 링크 용량, 최대 R인 도착률을 가질 수 있다. 만약 $\lambda\prime_{in}$이 모든 연결(B ~ D 연결을 포함하는)에 대해 매우 크다면, R2의 B ~ D 트래픽 도착률은 A ~ C 트래픽 도착률보다 클 수 있다. A ~ C와 B ~ D 트래픽은 버퍼 공간을 R2 라우터에서 경쟁해야 하므로, R2를 성공적으로 통과하는 A ~ C 트래픽의 양은 B ~ D에서 제공된 부하가 크면 클수록 작아진다. 제공된 부하가 무한대에 가까워지면 R2의 빈 버퍼는 즉시 B ~ D 연결의 버퍼로 채워지고 R2에서 A ~ C 연결의 처리량은 0이 된다. 이것은 트래픽이 많은 경우 A ~ C 종단 간 처리율이 0이 된다는 것을 의미한다. 그리고 제공된 부하와 처리량 간에는 트레이드오프가 있다는 것을 알 수 있다.

제공된 부하의 증가에 따른 처리량 감소의 원인은 네트워크가 수행한 '헛된 작업'의 양을 고려해보면 확실해진다. 패킷이 두 번째 홉의 라우터에서 버려질 때마다, 두 번째 홉 라우터에게 패킷을 전달하는 첫 번째 홉 라우터에서 수행된 작업은 헛된 것이 된다. **여기서 혼잡때문에 패킷을 버려야 하는 또 다른 비용을 확인할 수 있다. 패킷이 경로상에서 버려질 때, 버려지는 지점까지 패킷을 전송하는 데 사용된 상위 라우터에서 사용된 전송 용량은 낭비된 것이다.**


## 2. 혼잡 제어에 대한 접근법
이번 절에서는 실제로 혼잡 제어를 수행하기 위한 두 가지 광범위한 접근 방식을 살펴보고 그 방식을 구현하는 특정 네트워크 구조와 혼잡 제어 프로토콜에 대해서 논의한다. 가장 크게 보면, 네트워크 계층이 혼잡 제어를 목적으로 트랜스포트 계층에게 어떤 직접적인 도움을 제공하는지에 따라 혼잡 제어 접근을 구별할 수 있다.

- **종단 간의 혼잡 제어**: 혼잡 제어에 대한 종단 간의 접근 방식에서 네트워크 계층은 혼잡 제어의 목적을 위해 트랜스포트 계층에게 직접적인 지원을 어떤 것도 제공하지 않는다. 네트워크에서 혼잡의 존재는 단지 관찰된 네트워크 동작(ex. 패킷 손실 및 지연)에 기초해 종단 시스템이 추측해야 한다. TCP 세그먼트 손실은 네트워크 혼잡의 발생이라고 간주하고 TCP는 그에 따라 윈도 크기를 줄인다. 또한 TCP에 대한 새로운 제안으로, 증가하는 왕복 지연값을 네트워크 혼잡 증가 지표로 사용하게 되는 것을 보게 될 것이다.
- **네트워크 지원 혼잡 제어**: 네트워크 지원 혼잡 제어에서 라우터들은 네트워크 안에서 혼잡 상태와 관련해 송신자나 수신자 또는 모두에게 직접적인 피드백을 제공한다. 이 피드백은 링크의 혼잡을 나타내는 하나의 비트처럼 간단하다.