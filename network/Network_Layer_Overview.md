H1(호스트 1)과 H2의 경로상에 여러 라우터가 있는 간단한 네트워크를 생각해보자. 그리고 호스트와 중계 라우터에서의 네트워크 계층의 역할을 생각해보자. H1 네트워크 계층은 H1의 트랜스포트 계층으로부터 세그먼트를 얻어 각 세그먼트를 얻어 각 세그먼트를 데이터그램으로 캡슐화하고, 인접한 라우터 R1에게 데이터그램을 보낸다. 수신 호스트 H2의 네트워크 계층은 트랜스포트 계층 세그먼트를 추출하여 H2의 트랜스포트 계층까지 전달한다. 각 라우터의 데이터 평면 역할은 입력 링크에서 출력 링크로 데이터그램을 전달하는 것이다. 네트워크 제어 평면의 근본적인 역할은 데이터그램이 출발지 호스트에서 목적지 호스트까지 잘 전달되게끔 로컬 포워딩, 라우터별 포워딩을 대응시키는 것이다. 라우터는 트랜스포트 계층과 애플리케이션 계층을 지원하지 않으므로 프로토콜 스택에서 네트워크 계층의 상위 계층은 존재하지 않는다.


## 1. 포워딩과 라우팅: 데이터 평면과 제어 평면
네트워크 계층의 근본적인 역할은 매우 단순하다. 바로 송신 호스트에서 수신 호스트로 패킷을 전달하는 것이다. 이를 위한 중요한 기능 두 가지를 다음과 같이 정의한다.

- **포워딩(전달)**: 패킷이 라우터의 입력 링크에 도달했을 때 라우터는 그 패킷을 적절한 출력 링크로 이동시켜야 한다. 포워딩에서 예외적으로 하나의 기능은 데이터 평명에서 실행된다. 더 일반적인 사례에서는 패킷이 라우터에서 나갈 때 막힐 수도 있고, 복제되어 여러 링크로 전송될 수 있다.
- **라우팅**: 송신자가 수신자에게 패킷을 전송할 때 네트워크 계층은 패킷 경로를 결정해야 한다. 이러한 경로를 계산하는 알고리즘을 **라우팅 알고리즘**이라고 한다. 그리고 패킷 전송 라우팅은 네트워크 계층의 제어 평면에서 실행된다.

네트워크 계층을 논할 때는 **포워딩**과 **라우팅**이라는 용어의 의미가 혼용되곤 한다. 이번 절에서 이 용어들을 더 정확하게 정의할 것이다. **포워딩**은 매우 짧은 시간(보통 나노초) 단위를 갖기에, 대표적으로 하드웨어에서 실행된다. 반면에, **라우팅**은 네트워크 전반에 걸쳐 출발지에서 목적지까지 데이터그램의 종단 간 경로를 결정하는 것이다. 라우팅은 더 긴 시간(보통 초) 단위를 갖기에 보통 소프트웨어에서 실행된다. 

네트워크 라우터에서 필수 불가결한 요소는 **포워딩 테이블**이다. 라우터는 도착하는 패킷 헤더의 필드값을 조사해 패킷을 전달한다. 이 값을 그 라우터에 해당하는 포워딩 테이블위 내부 색인으로 사용한다. 포워딩 테이블 엔트리에 저장되어 있는 헤더의 값은 해당 패킷이 전달되어야 할 라우터의 외부 링크 인터페이스를 나타낸다. 네트워크 계층 프로토콜에 따라, 헤더의 값은 패킷의 목적지 주소이거나 패킷이 속한 연결의 지시일 수 있다. 

### 1.1 제어 평면: 전통적인 접근 방법
라우팅 알고리즘은 모든 라우터에서 실행되며, 라우터는 포워딩과 라우팅 기능을 모두 갖고 있어야 한다. 라우터의 라우팅 알고리즘은 다른 라우터의 라우팅 알고리즘과 소통하며 포워딩 테이블의 값을 계산한다. 그런 소통은 라우팅 프로토콜에 따라 라우팅 정보가 포함된 라우팅 메세지를 교환하며 이루어진다.
