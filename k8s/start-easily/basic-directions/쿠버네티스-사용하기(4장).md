# yaml 파일 알아보기
쿠버네티스 환경에서 오브젝트(디플로이먼트, 파드 등)를 어떻게 배포할 건지 정의하는 것은 매니페스트라는 파일을 통해 이루어진다. 매니페스트는 쿠버네티스의 오브젝트를 생성하기 위한 메타 정보를 yaml이나 json으로 기술한 파일을 말한다. 

# 크론잡 사용하기
쿠버네티스에서 사용하는 잡은 다음과 같은 두 가지 유형으로 나뉜다.

1. 잡
   1. Run-to-Completion 이라고도 불림
2. 크론잡

잡은 하나 이상의 파드가 특정한 파드의 정상적인 상태를 유지할 수 있도록 관리한다. 즉, 노드(혹은 시스템)에 문제가 발생해서 특정 파드에 문제가 발생하면 정상적인 서비스를 유지하도록 새로운 파드를 다시 만드는 역할을 한다. 

크론잡은 주기적으로 어떤 액션을 발생시키는 잡이다. 어떤 액션을 얼마나 자주 발생시킬지는 매니페스트에서 지정한다. 특정 시기에 주기적으로 발생시켜야 하는 작업을 명시하는 성질 덕에 애플리케이션이나 데이터를 백업하는 용도로 주로 사용한다.

다른 매니페스트와 달리 `schedule`(얼마나 자주), `command`(어떤 행동을 수행) 부분이 추가로 기술되어진다. 

```yaml
apiVersion: batch/v1
kind: CronJob
metadata:
  name: hello
spec:
  schedule: "*/1 * * * *"
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: hello
            image: busybox
            imagePullPolicy: IfNotPresent
            command:
            - /bin/sh
            - -c
            - date; echo Hello from the Kubernetes cluster
          restartPolicy:  OnFailure
```

```bash
kubectl create -f cronjob.yaml
```

```bash
kubectl delete cronjob hello
```

# CoreDNS 알아보기
CoreDNS는 쿠버네티스에서 DNS 서비스를 제공하는 데 사용되는 오픈 소스 DNS 서버이다. 쿠버네티스 클러스터 내에서 서비스 이름을 DNS로 해결할 수 있도록 도와준다. CoreDNS는 쿠버네티스의 DNS 서버로 사용되며, kubeadm으로 설치하면 기본적으로 설치된다.

```bash
kubect get po -n kube-system -l k8s-app=kube-dns
```

위의 (CoreDNS 파드를 조회하는) 명령어를 사용해보면 CoreDNS는 두 개의 파드로 구성되어 있다. 이 두 개의 파드에 대한 서비스는 kube-system 네임스프에스에서 kube-dns라는 이름으로 실행된다. 다음 명령어는 `kube-dns` 라는 서비스를 확인한다.

```bash
kubectl get svc -n kube-system -l k8s-app=kube-dns
```

확인해보면 TCP와 UDP 모두 53 포트를 사용한다. 이는 DNS가 일반적으로 53 포트를 사용하는 것과 연관이 있다.

`kubectl describe cm -n kube-system coredns` 명령어를 이용하면 CoreDNS의 내용을 담고 있는 Corefile 정보를 확인할 수 있다. 이 명령어에서 `cm`은 ConfigMap의 약어이다.

# 컨피그맵과 시크릿 알아보기
컨피그맵은 환경 변수 같은 값을 도커 이미지에 포함시키지 않고 별도로 분리해서 관리하는 방법을 제공한다. 즉, 기밀이 아닌 데이터를 키-값 상으로 저장하는데에 사용한다고 할 수 있다. 반면 시크릿은 외부에 노출되어선 안되는 정보들을 저장할 때 사용한다.

### 컨피그맵 알아보기
컨피그맵도 다른 오브젝트와 마찬가지로 `kubectl create configmap` 명령어를 사용해 생성한다.

```bash
kubectl create configmap <map-name> <data-source> <arguments>
```
- map-name: 컨피그맵 이름
- data-source: 컨피그맵을 포함하는 파일 또는 디렉터리의 경로
- arguments: 컨피그맵을 생성하는 방법을 지정한다.
  - 파일로 생성: 파일/디렉터리(--from-file), 환경 파일(--from-env-file)
  - 문자로 생성: 리터럴 값(--from-literal)

### 시크릿 알아보기
시크릿도 비밀번호같은 민감한 정보들을 저장하는 용도로 사용한다. 이 정보들은 컨테이너에 저장하지 않고 별도로 보관해뒀다가 실제 파드가 실행할 때 시크릿 값을 가져와서 파드(컨테이너)에 제공한다.

사용 방법은 컨피그맵과 유사하다.

```bash
kubectl create secret generic "Secret 이름" --from-literal="Key1"="Value1" --from-literal="Key2"="Value2"
```