# 들어가며
- 파일 시스템이 파일과 디렉터리를 보조기억장치에 할당하고 접근하는 방법
- 대표적인 파일 시스템의 종류(FAT 파일 시스템, 유닉스 파일 시스템) 학습

# 파티셔닝과 포매팅
- 이제 막 공장에서 생산되어 한 번도 사용된 적이 없는 새 하드디스크/SSD
  - 파티셔닝, 포매팅을 하기 전까지는 사용할 수 없음
- 파티셔닝
  - 저장 장치의 논리적인 영역을 구획하는 작업
- 포매팅
  - 파일 시스템을 설정
    - 파일 시스템은 포매팅할 때 결정된다
  - 어떤 방법으로 파일을 관리할지 결정, 새로운 데이터를 쓸 준비하는 작업
  - 파일 시스템은 굉장히 많은 종류가 있고,
  - 파티션마다 다른 파일 시스템을 설정할 수도 있음
  - 포매팅까지 완료해서 파일 시스템을 설정했다면 파일과 디렉터리 생성이 가능하다

# 파일 할당 방법
- 운영체제는 파일/디렉터리를 블록 단위로 읽고 쓴다
  - 즉, 하나의 파일이 보조기억장치에 저장될 땐 여러 블록에 걸쳐 저장된다
  - > 하드디스크의 가장 작은 저장 단위는 섹터이지만 보통 블록 단위로 읽고 쓴다
    

- 파일을 보조기억장치에 할당하는 두 가지 방법
  - 연속 할당
  - 불연속 할당
    - 연결 할당
    - 색인 할당

## 연속 할당
- 이름 그대로 보조기억장치 내의 연속적인 블록에 파일을 할당
- 연속된 파일에 접근하기 위해 파일의 첫 번째 블록 주소와 블록 단위의 길이만 알면 된다
- 디렉터리 엔트리: 파일 이름 & 첫 번째 블록 주소 & 블록 단위 길이 명시
- 단점: 구현이 단순하지만 외부 단편화를 야기할 수 있다.
    - 그래서 오늘날엔 불연속 할당이 사용됨

## 불연속 할당 - 연결 할당
- 각 블록 일부에 다음 블록의 주소를 저장하여 각 블록이 다음 블록을 가리키는 형태로 할당
- 파일을 이루는 데이터 블록을 연결 리스트로 관리
- 불연속 할당의 일종: 파일이 여러 블록에 흩어져 저장되어도 무방
- 디렉터리 엔트리: 파일 이름 & 첫 번째 블록 주소 & 블록 단위의 길이
- 단점
  - 반드시 첫 번째 블록부터 하나씩 읽어들여야 함
  - 오류 발생 시 해당 블록 이후 블록은 접근이 어려움

## 불연속 할당 - 색인 할당
- 파일의 모든 블록 주소를 색인 블록이라는 하나의 블록에 모아 관리하는 방식
- 파일 내 임의의 위치로 접근하기가 용이함
- 디렉터리 엔트리: 파일 이름 & 색인 블록 주소

# FAT 파일 시스템
- 연결 할당 기반 파일 시스템
- 연결 할당의 단점을 보완
- 각 블록에 포함된 다음 블록 주소를 한데 모아 테이블(FAT: File Allocation Table)로 관리
- FAT 데이터가 캐싱될 수 있음
  - 이것을 이유로 접근 속도가 개선될 수 있음


- 오늘날 USB 메모리, SD 카드같은 저용량 저장장치에서 많이 사용됨, MS-DOS에서도 썼었음

# 유닉스 파일 시스템
- 색인 할당 기반 파일 시스템
- 색인 블록 == i-node
  - 파일의 속성 정보와 15개의 블록 주소 저장 가능


1. 블록 주소 중 12개에는 직접 블록 주소 저장
   - 직접 블록: 파일 데이터가 저장된 블록
2. 1번으로 충분하지 않다면 13번째 주소에 단일 간접 블록 주소 저장
   - 단일 간접 블록: 파일 데이터를 저장한 블록 주소가 저장된 블록
3. 2번으로 충분하지 않다면 14번째 주소에 이중 간접 블록 주소 저장
   - 이중 간접 불록: 단일 간접 블록들의 주소를 저장하는 블록
4. 3번으로 충분하지 않다면 15번째 주소에 삼중 간접 블록 주소 저장
    - 삼중 간접 불록: 이중 간접 블록들의 주소를 저장하는 블록

- 디렉터리 엔트리: i-node가 파일 시스템의 핵심
