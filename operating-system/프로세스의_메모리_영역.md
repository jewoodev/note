# 프로세스의 메모리 영역

프로세스가 사용자 영역에 배치될 땐 크게 **코드 영역**, **데이터 영역**, **힙 영역**, **스택 영역**으로 나뉘어서 저장된다. 

## 코드 영역

코드 영역(code segment)은 텍스트 영역(text segment)라고도 부른다. 이 곳은 이름대로 실행할 수 있는 코드, 기계어로 이루어진 명령어가 저장된다. 코드 영역에는 데이터가 아닌 CPU가 실행할 명령어가 담겨 있기 때문에 쓰기가 금지되어 있는, 읽기 전용 공간이다.

## 데이터 영역

데이터 영역(data segment)은 잠깐 썼다가 없앨 데이터가 아닌 프로그램이 실행되는 동안 유지할 데이터가 저장되는 공간이다. 이런 데이터로는 전역 변수(global variable)가 대표적이다. 

코드 영역과 데이터 영역은 그 크기가 변하지 않는다. 왜냐하면, 프로그램을 구성하는 명령어들이 갑자기 바뀔 일이 없으니 코드 영역의 크기가 변할 리 없고, 데이터 영역에 저장될 내용은 프로그램이 실행되는 동안만 유지될 데이터이기 때문이다. 그래서 두 영역을 정적 할당 영역(크기가 고정된 영역)이라고 부른다. 

반면 힙 영역과 스택 영역은 프로세스 실행 과정에서 크기가 변할 수 있다. 그래서 동적 할당 영역이라 부른다.

## 힙 영역

힙 영역(heap segment)은 프로그램을 만드는 사용자, 즉 프로그래머가 직접 할당할 수 있는 저장 공간이다. 

만약 프로그래밍 과정에서 힙 영역에 메모리 공간을 할당했다면 언젠가는 해당 공간을 반환해야 한다. 메모리 공간을 반환한다는 의미는 "더 이상 해당 메모리 공간을 사용하지 않겠다" 라고 운영체제에 말해주는 것과 같다.

메모리 공간을 반환하지 않는다면 할당한 공간은 메모리 내에 계속 남아 메모리 낭비를 초래한다. 이런 문제를 **메모리 누수**라고 한다. 

## 스택 영역

스택 영역(stack segment)은 데이터를 일시적으로 저장하는 공간이다. 대표적으로 함수의 실행이 끝나면 사라지는 매개 변수, 지역 변수가 있다.

일시적으로 저장할 데이터는 스택 영역에 PUSH되고, 더 이상 필요하지 않은 데이터는 POP됨으로써 스택 영역에서 제거된다.

힙 영역과 스택 영역은 실시간으로 그 크기가 변할수 있기 때문에 동적 할당 영역이라 부른다. 두 영역이 동적으로 할당되어도 주소가 겹치지 않도록 하기 위해서 힙 영역은 메모리의 낮은 주소에서 높은 주소로, 스택 영역은 높은 주소에서 낮은 주소로 할당되는게 일반적이다.