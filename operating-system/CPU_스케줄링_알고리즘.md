# CPU 스케줄링 알고리즘

이것의 종류는 매우 다양하고 운영체제마다 채택하는 것도 다르다. 알고리즘에서 "아이디어"를 빼먹어 보자.

## 선입 선처리 스케줄링

줄여서 FCFS(Firtst Come First Served Scheduling)이라고도 부른다. 이름대로 준비 큐에 삽입된 순서대로 프로세스를 처리하는 비선점형 방식이다.

이 알고리즘은 때때로 프로세스들이 기다리는 시간이 매우 길어질 수 있다는 단점이 있다. 

만약 CPU를 이용하는 시간이 17ms 인 프로세스, 5ms 인 프로세스, 2ms 인 프로세스 순으로 준비 큐에 삽입된다면 마지막 프로세스는 고작 2ms동안 CPU를 사용하기 위해 22ms를 기다려야 한다.

이런 현상을 호위 효과(convoy effect)라고 한다. 

## 최단 작업 우선 스케줄링

호위 효과를 방지하기 위해 준비 큐에 삽입된 프로세스들 중 CPU의 이용 시간이 가장 짧은 프로세스부터 실행하는 방식이다. 줄여서 SJF(Shortest Job First Scheduling)이라고 한다. 

이 스케줄링은 기본적으로 비선점형 스케줄링 알고리즘으로 분류되지만, 선점형으로 구현될 수도 있다. 

## 라운드 로빈 스케줄링

선입 선처리 스케줄링에 타임 슬라이스라는 개념이 더해진 방식이다. 타임 슬라이스란 각 프로세스가 CPU를 사용할 수 있는 정해진 시간을 의미한다. 이 개념을 적용해 정해진 타임 슬라이스만큼의 시간 동안 돌아가면서 CPU를 선점형으로 사용한다. 

만약 CPU 사용 시간이 11ms, 3ms, 7ms 인 프로세스를 타임 슬라이스가 4ms 인 라운드 로빈 스케줄링을 하면 11ms동안 다 쓰지 못하고 3ms 동안 쓰는 프로세스에게 넘기며 스케줄링이 수행된다.

이 방식에선 타임 슬라이스의 크기가 매우 중요하다. 타임 슬라이스가 너무 크면 선입 선처리 스케줄링과 다를 바 없이 후위 효과가 생기고, 너무 작으면 문맥 교환에 발생하는 비용이 커서 CPU가 프로세스를 처리하는 것보다 프로세스를 전환하는데에 온 힘을 다 쓸 수도 있기 때문이다. 

## 최소 잔여 시간 우선 스케줄링

이건 최단 작업 우선 스케줄링과 라운드 로빈 스케줄링을 합친 방식이다. 최소 잔여 시간 우선 스케줄링에서 프로세스들은 정해진 타임 슬라이스동안 CPU를 사용하되, CPU를 사용할 다음 프로세스는 남아있는 작업시간이 가장 적은 프로세스를 선택한다. 

## 우선순위 스케줄링

프로세스들에 우선순위를 부여하고, 가장 높은 우선순위를 가진 것부터 실행하는 알고리즘이다. 

최단 작업 우선 스케줄링과 최소 잔여 시간 우선 스케줄링은 넓은 의미에서 우선순위 스케줄링의 일종이라고 볼 수 있다. 

우선순위 스케줄링은 근본적인 문제를 내포하고 있는데 우선순위가 낮은 프로세스는 우선순위가 높은 프로세스들에 순서가 밀려 실행이 계속해서 연기될 수 있다는 점이다. 이를 **기아**(starvation) 현상이라고 한다. 

이를 방지하기 위한 기법들 중 대표적인 것으로 **에이징**이 있는데, 이는 오랫동안 대기한 프로세스의 우선순위를 점차 높이는 방식이다.

## 다단계 큐 스케줄링

우선순위 스케줄링의 발전된 형태로 우선순위별로 준비 큐를 여러 개 사용한다. 우선순위가 가장 높은 큐에 있는 프로세스들을 먼저 처리하고, 가장 높은 큐가 비어 있으면 그 다음 우선순위 큐에 있는 프로세스들을 처리한다.

이 방식은 어떤 큐에는 CPU 집중 프로세스를 삽입할 수 있고, 어떤 큐에는 입출력 집중 프로세스를 삽입할 수 있고, 어떤 큐에는 우선순위가 더 비교적 높아야 하는 백그라운드 프로세스들을 삽입할 수 있고, 어떤 큐에는 비교적 낮아도 되는 사용자와의 상호작용이 잦은 프로세스들을 삽입할 수 있다. 이를 통해 우선순위 관리를 더 강력하게 할 수 있게 된다.

## 다단계 피드백 큐 스케줄링

다단계 큐 스케줄링의 발전된 형태다. 뭘 발전시켰냐, 바로 알아보겠다.

다단계 큐는 기아 현상이 발생할 위험이 있다. 큐 사이를 이동할 수 없어 우선순위가 낮은 프로세스가 계속 연기될 수 있기 때문이다. 바로 이 위험성을 보완한 형태이다.

다단계 피드백 큐 스케줄링은 새로 준비 상태가 된 프로세스가 있다면 우선 우선순위가 가장 높은 우선순위 큐에 삽입하고 타임 슬라이스동안 실행한다.

그리고 만약 프로세스의 실행이 해당 큐에서 끝나지 않는다면 다음 우선순위 큐에 삽입되어 실행된다. 그 후에 그 큐에서도 실행이 끝나지 않으면 또 다음 우선순위 큐에 삽입되면서, 결과적으로 CPU를 오래 사용해야 하는 프로세스는 점차 우선순위가 낮아지게 된다.

반대로 CPU를 상대적으로 적게 사용하는 입출력 집중 프로세스들은 자연스레 우선순위가 높은 큐에서 실행이 끝나게 된다. 

그리고 다단계 피드백 큐 스케줄링은 프로세스들이 큐 사이를 이동할 수 있는 방식이라 낮은 우선순위 큐에서 너무 오래 기다리고 있는 프로세스가 있으면 점진적으로 우선순위가 높은 큐로 이동시키는 에이징 기법으로 기아 현상을 예방할 수 있다. 

이런 방식으로 동작하는 다단계 피드백 큐 스케줄링은 구현이 복잡하지만, 가장 일반적인 CPU 스케줄링 알고리즘으로 알려져있다.

