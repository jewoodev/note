회원가입 요청에 해당하는 DTO는 비밀번호를 인코딩 처리해야하기 때문에 완전히 불변성을 띄는 데이터라고 보기는 어렵다. 이런 경우에는 어떤 걸 쓰는게 좋을까?

1. **Record vs Class 선택 기준**

- Record는 불변(immutable) 데이터 전송 객체(DTO)를 위한 완벽한 선택이다.
- 특히 데이터를 단순히 전달하는 용도로는 Record가 더 간결하고 안전하다.
- 하지만 데이터 변환이나 수정이 필요한 경우 Class가 더 적합할 수 있다.

2. **현재 상황 분석**

- 회원가입 DTO에서 비밀번호 인코딩이 필요하다는 것은 데이터 변환이 필요하다는 의미이다.
- Record는 불변성을 강제하기 때문에, 비밀번호를 인코딩한 후 새로운 객체를 생성해야 한다.
- 이는 메모리 사용 측면에서 비효율적으로 보일 수 있습니다

3. **Best Practice 관점**

- 보안 관점에서는 비밀번호를 인코딩한 후 새로운 객체를 생성하는 것이 더 안전하다.
- 원본 비밀번호가 남아있지 않기 때문이다.
- 성능상의 미세한 차이는 보안보다 덜 중요하다.

4. **권장 접근 방식**

- 현재 상황에서는 Record를 계속 사용하는 것을 권장한다.
- 비밀번호 인코딩은 서비스 레이어에서 처리하고, 인코딩된 비밀번호로 새로운 Record를 생성하는 것이 좋다.

이는 불변성과 보안을 모두 만족시키는 방식이다. '보안적으로 왜 더 뛰어난가' 에 대해서 설명해보자면, Record를 사용할 때와 Class를 사용할 때 중요한 차이가 있기 때문이다.

1. **메모리 관점의 보안**

- Record로 새로 생성하는 경우: 원본 비밀번호가 담긴 객체는 GC에 의해 즉시 회수될 수 있다.
- Setter로 변경하는 경우: 원본 비밀번호가 담긴 객체가 메모리에 더 오래 남아있을 수 있다.
- 특히 힙 덤프나 메모리 분석 공격에 노출될 위험이 더 크다.

2. **불변성(Immutability)의 보안적 이점**

- Record는 불변성을 강제하므로, 한번 생성된 후에는 값이 변경될 수 없다.
- 이는 의도하지 않은 비밀번호 노출이나 변경을 방지한다.
- Setter를 사용하면 객체의 상태가 변경 가능하므로, 보안 취약점이 될 수 있다.

3. **객체 재사용의 위험성**

- Setter를 사용하면 같은 객체를 재사용하게 된다.
- 이는 객체의 라이프사이클이 더 길어질 수 있고, 다양한 컨텍스트에서 재사용될 위험이 있다.
- 새로 생성하는 방식은 각 단계별로 새로운 객체를 사용하므로, 객체의 사용 범위가 명확하다.

4. **디버깅과 추적의 용이성**

- Record로 새로 생성하면 각 단계별로 다른 객체 ID를 가지게 된다.
- 이는 디버깅이나 로깅 시 어떤 시점의 객체인지 추적하기 쉽다.
- Setter를 사용하면 같은 객체가 계속 변경되므로 추적이 어려울 수 있다.