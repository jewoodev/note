# RAID
- 보조기억장치
  - 하드 디스크 드라이브
  - 플래시 메모리 기반 저장장치
    - SSD(Solid-State Drive)

- RAID(Redundant Array of Independent Disks)
  - 데이터의 안정성 혹은 성능을 확보하기 위해 여러 개의 독립적인 보조기억장치를 마치 하나의 보조기억장치처럼 사용하는 기술
- RAID를 구성하는 방법: RAID 레벨
  - RAID0, RAID1, RAID2, RAID3, RAID4, RAID5, RAID6이 대표적이며, RAID10, RAID50 등

## RAID0
- 데이터를 여러 보조기억장치에 단순하게 나누어 저장하는 구성 방식
  - 스트라입: 마치 줄무늬처럼 분산되어 저장된 데이터
  - 스트라이핑: 분산하여 저장하는 동작
  - 장점: 빠른 입출력 속도
    - 4TB인 저장장치 1개보다 RAID0으로 구성된 1TB인 저장장치 4개의 속도가 이론상 4배 가량 빠름
  - 단점: 저장된 정보가 안전하지 않음
    - 만약 하드 디스크1에 문제가 생긴다면 하드 디스크 2, 3, 4에 저장된 데이터는 불완전한 데이터

## RAID1
- 완전한 복사본을 만들어 저장하는 구성 방식
  - 미러링(mirroring)
  - 장점: 복구가 간단하고 안전성이 높음
  - 단점: 복사본이 저장된 크기만큼 사용 가능한 용량이 적어짐
    - 원본과 복사본 두 곳에 써야하기 때문에 RAID0보다 쓰기 속도가 느림

## RAID4
- 패리티 정보를 저장하는 디스크를 따로 두는 구성 방식
  - 패리티(parity): 오류를 검출할 수 있는 정보
  - 장점: RAID1에 비해 적은 하드 디스크로도 안전하게 데이터를 보관
  - 단점: 패리티를 저장하는 장치에 병목 현상이 발생

## RAID5
- 패리티를 분산하여 저장하는 구성 방식
- RAID4의 단점인 병목 현상을 보완

## RAID6
- 서로 다른 2개의 패리티를 두는 구성 방식
  - 오류를 검출하고 복구할 수 있는 수단이 2개: RAID6은 RAID4나 RAID5에 비해 안전성이 높음
  - 단점: 새로운 정보를 저장할 때마다 함께 저장할 패리티가 2개이므로 RAID5에 비해 쓰기 속도는 느림

---

# 입출력 기법
## 장치 컨트롤러와 장치 드라이버
- 장치(device) 컨트롤러
  - CPU와 입출력장치 사이의 통신을 중개하는 중개자 역할의 하드웨어
  - 모든 입출력장치는 각자의 장치 컨트롤러를 통해 컴퓨터 내부와 연결되어 정보를 교환
- 장치 드라이버
  - 장치 컨트롤러의 동작을 알고, 장치 컨트롤러가 컴퓨터 내부와 정보를 주고받을 수 있도록 하는 프로그램

## 프로그램 입출력
- 프로그램 입출력(Programmed I/O): 프로그램 속 명령어로 입출력 작업을 수행하는 방법

## 인터럽트 기반 입출력: 다중 인터럽트
- 인터럽트가 여러 입출력장치로부터 동시다발적으로 발생하는 경우의 인터럽트 처리
  - 키보드, 마우스, 모니터, 스피커 등의 입출력장치를 동시에 사용하는 상황
  - CPU가 플래그 레지스터 속 인터럽트 비트를 비활성화한 채 인터럽트를 처리할 경우
    - 다른 하드웨어 인터럽트를 받아들이지 않기 때문에 CPU는 기본적으로 다음과 같이 인터럽트가 발생한 순서대로 인터럽트 서비스 루틴을 순차적으로 실행

- 인터럽트 중에서도 우선순위가 더 높은 인터럽트가 우선적으로 처리되는 경우가 일반적
  - ex) 현재 CPU가 인터럽트 A를 처리하는 도중에 또 다른 인터럽트 B가 들어왔다고 가정
    - 지금 처리 중인 인터럽트 A보다 인터럽트 B의 우선순위가 낮다면, CPU는 A를 모두 처리한 뒤에 B를 처리
    - 인터럽트 A보다 B의 우선순위가 높다면, CPU는 인터럽트 A의 실행을 잠시 멈추고 B를 처리한 뒤에 다시 A를 처리
  - CPU는 플래그 레지스터 속 인터럽트 비트가 활성화되어 있는 경우, 혹은 인터럽트 비트를 비활성화해도 무시할 수 없는 인터럽트인 NMI(Non-Maskable Interrupt)가 발생한 경우, 우선순위가 높은 인터럽트부터 처리

- 프로그래머블 인터럽트 컨트롤러(PIC)
  - 다중 인터럽트를 처리하기 위해 사용되는 하드웨어
  - PIC는 여러 장치 컨트롤러에 연결되어 있어 장치 컨트롤러에서 보낸 하드웨어 인터럽트 요청들의 우선순위를 판별한 뒤, CPU에게 지금 처리해야 할 하드웨어 인터럽트가 무엇인지를 알려 주는 장치
- PIC 각각의 핀에는 CPU에게 하드웨어 인터럽트 요청을 보낼 수 있도록 약속된 하드웨어가 연결
  - ex) 첫 번째 핀은 타이머 인터럽트를 받아들이는 핀이고, 두 번째 핀은 키보드 인터럽트를 받아들이는 핀 등

## DMA 입출력
- 프로그램 기반의 입출력과 인터럽트 기반의 입출력의 공통점
  - CPU가 입출력장치와 메모리 간의 데이터 이동을 주도해야 하며, 이동하는 데이터들도 반드시 CPU를 거침
  - ex1) 입출력장치의 데이터를 메모리에 저장하는 경우
    - CPU는 장치 컨트롤러로부터 데이터를 하나씩 읽어 레지스터에 적재, 적재한 데이터를 하나씩 메모리에 저장
  - ex2) 메모리 속 데이터를 입출력장치에 내보내는 경우
    - CPU는 메모리로부터 데이터를 하나씩 읽어 레지스터에 적재, 적재한 데이터를 하나씩 입출력장치에 내보냄.

- DMA(Direct Memory Access)
  - CPU를 거치지 않고도 입출력장치와 메모리가 상호작용할 수 있는 입출력 방식
  - DMA 입출력을 위해서는 시스템 버스에 연결된 DMA 컨트롤러라는 하드웨어
  - DMA 컨트롤러가 포함될 경우
    - DMA 컨트롤러는 시스템 버스에 연결
    - 입출력장치들의 장치 컨트롤러들은 입출력 버스와 연결

- DMA 입출력 과정
  1. CPU가 DMA 컨트롤러에게 입출력장치의 주소, 수행할 연산, 연산할 메모리 주소 등의 정보와 함께 **입출력 작업을 명령**
  2. DMA 컨트롤러가 CPU 대신 장치 컨트롤러와 상호작용하며 **입출력 작업을 수행**  
      이때 DMA 컨트롤러는 필요한 경우 메모리에 직접 접근하여 정보를 읽거나 씀  
      입출력장치와 메모리 사이에 주고 받을 데이터가 CPU를 거치지 않음
  3. DMA 컨트롤러는 입출력 작업이 끝나면 CPU에게 **인터럽트를 통해 작업이 끝났음을 알림**

- CPU 입장에서는 DMA 컨트롤러에게 입출력 작업 명령을 내리고, 인터럽트만 받으면 되기 때문에 입출력 부담을 크게 줄일 수 있음

> **사이클 스틸링**
> 
> - 버스는 공용 자원, 두 장치가 동시에 하나의 버스를 이용할 수 없다.
> - 시스템 버스도 마찬가지
>   - DMA 컨트롤러는 시스템 버스를 통해 메모리에 직접 접근이 가능하지만, 시스템 버스는 동시 사용이 불가능
>   - CPU가 시스템 버스를 사용할 때는 DMA 컨트롤러가 시스템 버스를 사용할 수 없고, DMA 컨트롤러가 시스템 버스를 사용할 때는 CPU가 시스템 버스를 사용할 수 없음
> - 따라서 DMA 컨트롤러는 CPU가 시스템 버스를 사용하지 않을 때마다 조금씩 사용하거나, CPU가 시스템 버스 사용을 양보
> - 이런 의미로 DMA 시스템 버스 사용을 사이클 스틸링이라고 함

- PCIe(Peripheral Component Interconnect express)
  - PCIe 버스는 PCI라는 입출력 버스의 발전된 형태
  - 오늘 날의 메인 보드에서 가장 대중적으로 볼 수 있는 입출력 버스 중 하나
  - SSD, GPU, 또 5장에서 학습할 네트워크 인터페이스 카드 등 다양한 입출력장치를 연결
