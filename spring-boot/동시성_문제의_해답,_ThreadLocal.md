# ThreadLocal

이건 스프링이 제공하는 동시성 문제의 해결 키이다. 

각 쓰레드마다 별도의 저장소를 만들어 사용하게 함으로써 동시에 다수의 쓰레드가 같은 공유 자원에 접근 후 수정을 하더라도 영향이 없도록 하는 방식이다.

## 사용시 주의사항

WAS는 보통 쓰레드 생성 비용을 효율적으로 사용하기 위해 쓰레드 풀을 사용한다. 효율적으로 컴퓨팅 자원이 쓰이는 거 너무 좋다, 그런데 여기에 쓰레드 로컬이 조합되면 큰 문제가 생겨날 수 있다.

쓰레드 A가 쓰레드 로컬을 사용해 일을 하고나서 그대로 쓰레드 풀로 돌아가서 죽지 않게되기 때문이다. 이로 인해 쓰레드 A가 사용했던 데이터를 쓰레드 로컬에 계속 갖고 있게 되어서 추후에 데이터를 조회할 때 쓰레드 A는 본인의 쓰레드 로컬에 저장한 값을 읽어 반환하게 된다. 이런 현상은 사용자 B가 사용자 A의 데이터를 확인하게 되는 심각한 문제를 야기한다.