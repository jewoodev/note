# 도커의 기본적인 명령어들
- `docker container run image_reference`
- `docker container run --interactive --tty ubuntu:latest`
  - **run 명령어의 플래그**:
    - `--detach`: 컨테이너를 백그라운드에서 실행하며 컨테이너 ID를 출력한다.
    - `--publish`: 컨테이너 포트를 호스트 컴퓨터에 공개한다.
- `docker container inspect container_name`
- 
- `docker container stats [container name]`
- `docker container rm --force $(docker container ls --all --quiet)`

주명령어 `docker container`, 부명령어 `run`, `inspect`, `top`, `stats`, `rm` 

# 컨테이너란 무엇인가?
말 그대로 물건을 담는 컨테이너와 다를 것이 없다. 애플리케이션이 들어 있는 어떤 상자를 상상해보자. 이 상자 안에는 애플리케이션과 애플리케이션을 실행할 컴퓨터(IP주소, 컴퓨터 이름, 디스크 드라이브 등)가 함께 들어 있다. 이 상자 안의 호스트명, IP주소, 파일 시스템까지 모든 건 도커가 만들어낸 가상 리소스다. 이것들이 엮여 애플리케이션이 동작할 수 있는 환경이 만들어진다. 

상자 안에서는 상자 밖의 환경을 볼 수 없다. 상자는 어떤 컴퓨터 상에서 동작하는 것이고, 그 컴퓨터는 이 상자 말고도 다른 상자를 여러 개 실행할 수 있다. 각 상자들은 서로 독립적인 환경을 갖지만 상자가 실행되는 컴퓨터의 CPU, 메모리, 운영체제를 공유한다.

이러한 구조가 중요한 이유는 격리와 밀집이라는 모순된 조건을 동시에 만족할 수 있기 때문이다. 애플리케이션을 구성하는 컴포넌트들이 필요로 하는 런타임이 서로 다를 수 있고, 서로 호환되지 않는 버전의 라이브러리를 사용하는 등의 상황에서 애플리케이션은 서로 독립된 환경에서 실행되어야 한다. 하지만 그러면 한 컴퓨터에서 여러 애플리케이션을 실행할 수 없게 되고, 밀집을 달성할 수 없다. 

이 모순된 조건을 동시에 달성하려면 첫 번째 시도는 가상 머신을 사용하는 것이었다. 각각의 가상머신은 자신만의 운영체제를 별도로 갖는다. 이 운영체제는 애플리케이션이 사용해야 할 CPU와 메모리 자원을 상당량 차지하고, 운영체제 라이선스 비용과 운영체제 업데이트 설치 부담이 추가로 생긴다. 결국 격리는 달성할 수 있지만 밀집은 제공하지 못한다.

컨테이너는 호스트 컴퓨터의 운영체제를 공유함으로써 필요한 리소스를 크게 줄인다. 그만큼 실행이 빠르고 같은 호스트 컴퓨터에서 더 많은 수의 애플리케이션을 실행할 수 있다. 거기에 더해 외부와 독립된 환경을 제공해 밀집과 격리가 동시에 달성된다. 이게 도커의 특성 중 하나인 효율성이다.

# 도커가 컨테이너를 실행하는 원리
도커를 설치하고 컨테이너를 실행하는 일은 매우 간단하지만 여러 컴포넌트가 이에 관여한다.

- **도커 엔진**은 도커의 관리 기능을 맡는 컴포넌트다. 로컬 이미지 캐시를 담당하여 새로운 이미지가 필요하면 이미지를 내려받고, 기존 이미지가 있으면 기존 이미지를 사용한다. 호스트 운영체제와 함께 컨테이너와 가상 네트워크 등 도커 리소스를 만드는 일도 담당한다. 도커 엔진은 항시 동작하는 백그라운드 프로세스다.
- 도커 엔진은 도커 API를 통해 맡은 기능을 수행한다. **도커 API**는 표준 HTTP 기반 REST API다. 도커 엔진의 설정을 수정하면 이 API를 네트워크를 경유해 외부 컴퓨터로부터 호출할 수 없도록 차단(default)하거나 허용할 수 있다.
- **도커 명령행 인터페이스**(도커 CLI)는 도커 API의 클라이언트이다. 우리가 `docker` 명령을 사용할 때 실제로 도커 API를 호출하는 것이 도커 CLI이다.

도커 API는 명세가 공개돼 있다. 그렇기에 도커 CLI 이외의 다른 클라이언트를 사용할 수 있다. 

도커 엔진은 `containerd` 라는 컴포넌트를 통해 컨테이너를 실제로 관리하는데, 이 컴포넌트는 호스트 운영체제가 제공하는 기능을 통해 컨테이너, 즉 가상 환경을 만든다. `containerd`는 CNCF에서 관리하는 오픈 소스 프로젝트이며, 컨테이너는 개방형 컨테이너 이니셔티브(Open Container Initiative, OCI)라는 이름으로 공개된 개방형 표준이라는 점을 알아두자.
